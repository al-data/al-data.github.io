var ENodeType={SMALL_RECON:1,MEDIUM_RECON:2,LARGE_RECON:3,SMALL_MAINFLEET:4,MEDIUM_MAINFLEET:5,LARGE_MAINFLEET:6,SMALL_CARRIER:7,MEDIUM_CARRIER:8,LARGE_CARRIER:9,SMALL_TRANSPORT:10,MEDIUM_TRANSPORT:11,LARGE_TRANSPORT:12,UNKNOWN2:13,UNKNOWN:97,SIREN:98,BOSS:99,props:{1:{name:"",diffIcon:"xiao"},2:{name:"",diffIcon:"zhong"},3:{name:"",diffIcon:"da"},4:{name:"",diffIcon:"xiao"},5:{name:"",diffIcon:"zhong"},6:{name:"",diffIcon:"da"},7:{name:"",diffIcon:"xiao"},8:{name:"",diffIcon:"zhong"},9:{name:"",diffIcon:"da"},10:{name:"",diffIcon:"xiao"},11:{name:"",diffIcon:"zhong"},12:{name:"",diffIcon:"da"},13:{name:"",diffIcon:""},97:{name:"",diffIcon:""},98:{name:"",diffIcon:""},99:{name:"",diffIcon:""}}},SIREN_ICONS=["aijiangBB","aijiangCL","aijiangDD","aijiangCV","mingyunnvshen","ougen_h","gaoxiong_h","xianghe","sairenboss","sairenhangmu","sairenhangmu_i","sairenqingxun","sairenqingxun_i","sairenquzhu","sairenquzhu_i","sairenzhanlie","sairenzhanlie_i","sairenzhongxun","sairenzhongxun_i","xili","shentong","niaohai","wudao","canglong","sairenquzhu_ii","sairenqingxun_ii","sairenzhongxun_ii","sairenzhanlie_ii","ganraozhe","sairenhangmu_ii","sairenqianting","sairenboss11","unknown3","aruituosha","xiefeierde","duosaitejun","shengwang","weiershiqinwang","xiefeierde_idol","kelifulan_idol","xipeier_idol","jiasikenie_idol","sipeibojue_5","chicheng_idol","Vtuber_aqua","vtuber_mio","vtuber_matsuri","vtuber_sora","vtuber_shion","vtuber_fubuki","shengdiyage","tiaoyu","weiqita","yalisangna","liekexingdun","guanghui","longqibing","teluntuo","lituoliao","xia","xiang","guinu","gaoxiong_alter","moye","yishi","sunying","aerjiliya","jialisuoniye","wokelan","jiasikenie"],MAP_TYPE=[{name:"World",key:"W"},{name:"Event",key:"E"}],CHAPTERS={W:["1","2","3","4","5","6","7","8","9","10","11","12","13"],E:["Effort, Hope, and Planning","Opposite Colored","Visitors","Fallen Wings","Spee","Neptunia","Winter's Crown","Glorious","Ink-stained Steel Sakura","Prelude","Iris of Light and Dark","Utawarerumono","Crimson Echoes","Kizuna","Scherzo","Ashen","Tragicomedy","Polaris","Hololive","Swirling Cherry Blossoms","Northern Overture","Microlayer Medley","Skybound Oratorio"]},WORLD_SUB_CHAPTERS={1:["1","2","3","4","1-HM","2-HM","3-HM","4-HM"],2:["1","2","3","4","1-HM","2-HM","3-HM","4-HM"],3:["1","2","3","4","5","1-HM","2-HM","3-HM","4-HM"],4:["1","2","3","4","5","1-HM","2-HM","3-HM","4-HM"],5:["1","2","3","4","5","1-HM","2-HM","3-HM","4-HM"],6:["1","2","3","4","5","1-HM","2-HM","3-HM","4-HM"],7:["1","2","3","4","5","1-HM","2-HM","3-HM","4-HM"],8:["1","2","3","4","5","1-HM","2-HM","3-HM","4-HM"],9:["1","2","3","4","5","1-HM","2-HM","3-HM","4-HM"],10:["1","2","3","4","5","1-HM","2-HM","3-HM","4-HM"],11:["1","2","3","4","1-HM","2-HM","3-HM","4-HM"],12:["1","2","3","4"],13:["1","2","3","4"],"Effort, Hope, and Planning":["SP1","SP2","SP3"],"Opposite Colored":["A1","A2","A3","A4","B1","B2","B3","B4","C1","C2","C3","C4","D1","D2","D3","D4","EX"],Kizuna:["SP1","SP2","SP3","SP4","Black-SP","EX"],"Iris of Light and Dark":["A1","A2","A3","B1","B2","B3","C1","C2","C3","D1","D2","D3","EX"],Utawarerumono:["SP1","SP2","SP3","SP4","EX"],Scherzo:["A1","A2","A3","B1","B2","B3","C1","C2","C3","D1","D2","D3","SP","EX"],Neptunia:["SP1","SP2","SP3","SP4","EX"],"Crimson Echoes":["A1","A2","A3","B1","B2","B3","C1","C2","C3","D1","D2","D3","EX"],"Fallen Wings":["A1","A2","A3","B1","B2","B3","C1","C2","C3","D1","D2","D3","EX"],Visitors:["A1","A2","A3","B1","B2","B3","C1","C2","C3","D1","D2","D3","EX"],Spee:["SP1","SP2","SP3"],Winter:["A1","A2","A3","B1","B2","B3","C1","C2","C3","D1","D2","D3","EX"],Glorious:["A1","A2","A3"],"Ink-stained Steel Sakura":["A1","A2","A3","B1","B2","B3","C1","C2","C3","D1","D2","D3","EX"],Prelude:["SP1","SP2","SP3"],Ashen:["A1","A2","A3","B1","B2","B3","AS1","AS2","BS1","BS2","C1","C2","C3","D1","D2","D3","CS1","CS2","DS1","DS2","SP","EX"],Tragicomedy:["A1","A2","A3","AS1","AS2","B1","B2","B3","C1","C2","C3","CS1","CS2","D1","D2","D3","SP","EX"],Polaris:["SP1","SP2","SP3","SP4","SP5","Special","EX"],Hololive:["TS1","T1","TS2","T2","TS3","T3","TS4","T4","TS5","T5","T6","HOLO-SP","EX"],"Swirling Cherry Blossoms":["A1","A2","A3","B1","B2","B3","C1","C2","C3","D1","D2","D3","SP","EX"],"Northern Overture":["A1","A2","A3","B1","B2","B3","C1","C2","C3","D1","D2","D3","SP","EX"],"Microlayer Medley":["A1","A2","A3","B1","B2","B3","C1","C2","C3","D1","D2","D3","SP","EX"],"Skybound Oratorio":["A1","A2","A3","B1","B2","B3","C1","C2","C3","D1","D2","D3","SP","EX"]},WORLD_DB_INDEX={1:["101","102","103","104","10101","10102","10103","10104"],2:["201","202","203","204","10201","10202","10203","10204"],3:["301","302","303","304","305","10301","10302","10303","10304"],4:["401","402","403","404","405","10401","10402","10403","10404"],5:["501","502","503","504","505","10501","10502","10503","10504"],6:["601","602","603","604","605","10601","10602","10603","10604"],7:["701","702","703","704","705","10701","10702","10703","10704"],8:["801","802","803","804","805","10801","10802","10803","10804"],9:["901","902","903","904","905","10901","10902","10903","10904"],10:["1001","1002","1003","1004","1005","11001","11002","11003","11004"],11:["1101","1102","1103","1104","11101","11102","11103","11104"],12:["1201","1202","1203","1204"],13:["1301","1302","1303","1304"],"Effort, Hope, and Planning":["2200001","2200002","2200003"],"Opposite Colored":["2100041","2100042","2100043","2100044","2100045","2100046","2100047","2100048","2100051","2100052","2100053","2100054","2100055","2100056","2100057","2100058","1120021"],Visitors:["2100001","2100002","2100003","2100004","2100005","2100006","2100011","2100012","2100013","2100014","2100015","2100016","1100020"],"Fallen Wings":["2100061","2100062","2100063","2100064","2100065","2100066","2100071","2100072","2100073","2100074","2100075","2100076","1150021"],Spee:["2200011","2200012","2200013"],Neptunia:["1080001","1080002","1080003","1080004","1080005"],Winter:["2100021","2100022","2100023","2100024","2100025","2100026","2100031","2100032","2100033","2100034","2100035","2100036","1090017"],Glorious:["1050011","1050012","1050013"],"Ink-stained Steel Sakura":["1110001","1110002","1110003","1110004","1110005","1110006","1110011","1110012","1110013","1110014","1110015","1110016","1110021"],Prelude:["1130001","1130002","1130003"],"Iris of Light and Dark":["1140001","1140003","1140004","1140011","1140013","1140014","1140005","1140007","1140008","1140015","1140017","1140018","1140021"],Utawarerumono:["1160001","1160002","1160003","1160004","1160005"],"Crimson Echoes":["1340001","1340002","1340003","1340004","1340005","1340006","1340011","1340012","1340013","1340014","1340015","1340016","1340021"],Kizuna:["1220001","1220002","1220003","1220004","1220005","1220021"],Scherzo:["1230001","1230002","1230003","1230004","1230005","1230006","1230011","1230012","1230013","1230014","1230015","1230016","1230017","1230021"],Ashen:["1250001","1250002","1250003","1250004","1250005","1250006","1250007","1250008","1250009","1250010","1250011","1250012","1250013","1250014","1250015","1250016","1250022","1250023","1250024","1250025","1250017","1250021"],Tragicomedy:["1260001","1260002","1260003","1260004","1260005","1260006","1260007","1260008","1260021","1260022","1260023","1260024","1260025","1260026","1260027","1260028","1260031","1260041"],Polaris:["1280001","1280002","1280003","1280004","1280005","1280031","1280041"],Hololive:["1290001","1290002","1290003","1290004","1290005","1290006","1290007","1290008","1290009","1290010","1290011","1290031","1290041"],"Swirling Cherry Blossoms":["1300001","1300002","1300003","1300004","1300005","1300006","1300021","1300022","1300023","1300024","1300025","1300026","1300041","1300051"],"Northern Overture":["1310001","1310002","1310003","1310004","1310005","1310006","1310021","1310022","1310023","1310024","1310025","1310026","1310041","1310051"],"Microlayer Medley":["1330001","1330002","1330003","1330004","1330005","1330006","1330021","1330022","1330023","1330024","1330025","1330026","1330041","1330051"],"Skybound Oratorio":["1360001","1360002","1360003","1360004","1360005","1360006","1360021","1360022","1360023","1360024","1360025","1360026","1360041","1360051"]};function populateMapTypeDrop(){$("#dropMapType").children().remove().end();for(let a=0;a<MAP_TYPE.length;a++)$("#dropMapType").append("<option value='"+MAP_TYPE[a].key+"'>"+MAP_TYPE[a].name+"</option>");let a=$("#dropMapType").val();populateChapterDrop(a)}function populateChapterDrop(a){if($("#dropChapter").children().remove().end(),$("#dropSubChapter").children().remove().end(),!!(a in CHAPTERS)){let b=CHAPTERS[a];for(let a=0;a<b.length;a++)$("#dropChapter").append("<option value='"+b[a]+"'>"+b[a]+"</option>");let c=$("#dropChapter").val();populateSubChapterDrop(c)}}function populateSubChapterDrop(a){if($("#dropSubChapter").children().remove().end(),!!(a in WORLD_SUB_CHAPTERS)){let b=WORLD_SUB_CHAPTERS[a];for(let a=0;a<b.length;a++)$("#dropSubChapter").append("<option value='"+a+"'>"+b[a]+"</option>")}}var WAVE_DB={};const Node=({expedId:a,level:b,bgIcon:c,diff:d,hasDiff:e,bossIcon:f,hasBossIcon:g,isSirenIcon:h})=>`
            <div class="node cloudy-gradient m-2 border rounded-lg shadow p-2 border-dark" style="width:125px; height:125px;">
                <a style="color:black;" href="/exped.html?id=${a}">
                    <div style="position:relative;">
                        <img style="width:100%;" src="img/nodes/${c}.png" />
                        ${e?`<div style="position:absolute; bottom:0; right:0; width:40px; height:auto; border:0px solid black;">
                            <img style="width:100%;" src="img/nodes/${d}.png" />
                         </div>`:``}
                        ${g?`<div style="position:absolute; right:0; margin:auto; height:auto; border:0px solid black; ${h?`top: 0; width: 50px;`:`bottom: 0; width:80px;`}">
                            <img style="width:100%;" src="img/nodes/${f}.png" />
                        </div>`:``}   
                        <div style="position:absolute; top:0; left:0px; width:auto; height:auto; border:1px solid #666666; padding:1px; padding-left:5px; padding-right:5px; border-radius:6px; background:#FFFFFF">
                            Lv.${b}
                        </div>
                    </div>
                </a>
            </div>
        `;function loadCurrent(){let a=$("#dropChapter").val(),b=$("#dropSubChapter").val();loadWaves(WORLD_DB_INDEX[a][b])}function validateLocalStorage(a,b,c){let d=!1;for(let e=0;e<MAP_TYPE.length;e++)a==MAP_TYPE[e].key&&(d=!0);if(!d)return!1;let e=b;return"Winter"==e&&(e="Winter's Crown"),!!(a in CHAPTERS&&-1!=CHAPTERS[a].indexOf(e))&&b in WORLD_SUB_CHAPTERS&&!(parseInt(c)>=WORLD_SUB_CHAPTERS[b].length)}function saveToLocalStorage(){if(!localStorage)return;let a=$("#dropMapType").val(),b=$("#dropChapter").val(),c=$("#dropSubChapter").val();localStorage.setItem("mapType",a),localStorage.setItem("chapter",b),localStorage.setItem("subChapter",c)}function loadFromLocalStorage(){if(!localStorage)return;let a=localStorage.getItem("mapType"),b=localStorage.getItem("chapter"),c=localStorage.getItem("subChapter");null===a||null===b||null===c||(validateLocalStorage(a,b,c)?($("#dropMapType").val(localStorage.getItem("mapType")),populateChapterDrop($("#dropMapType").val()),$("#dropChapter").val(localStorage.getItem("chapter")),populateSubChapterDrop($("#dropChapter").val()),$("#dropSubChapter").val(localStorage.getItem("subChapter"))):console.log("Invalid local storage found. Resetting."))}function init(){let a=loadDb();a.then(function(){populateMapTypeDrop(),loadFromLocalStorage(),loadCurrent(),$("#dropMapType").on("change",function(){let a=$("#dropMapType").val();populateChapterDrop(a),saveToLocalStorage(),loadCurrent()}),$("#dropChapter").on("change",function(){let a=$("#dropChapter").val();populateSubChapterDrop(a),saveToLocalStorage(),loadCurrent()}),$("#dropSubChapter").on("change",function(){saveToLocalStorage(),loadCurrent()}),$("#btnSearch").click(function(){let a=$("#dropChapter").val(),b=$("#dropSubChapter").val();loadWaves(WORLD_DB_INDEX[a][b])})})}function loadDb(){var a=$.getJSON("../data/wavedb.json",function(a){WAVE_DB=a});return Promise.all([a])}function loadWaves(a){if(!(a in WAVE_DB.chapters))return[];let b=WAVE_DB.chapters[a],c=b.ae,d=b.se,e=[],f=[],g=[];for(let b,h=0;h<d.length;h++){b=WAVE_DB.expeds[d[h]],e.push(b);let a=ENodeType.props[b.t],i={expedId:parseInt(d[h]),level:b.l,bgIcon:WAVE_DB.exIcons[b.ic],diff:a.diffIcon,hasDiff:""!=a.diffIcon,bossIcon:"enemy_boss",hasBossIcon:b.t==ENodeType.BOSS,isSirenIcon:-1!=SIREN_ICONS.indexOf(WAVE_DB.exIcons[b.ic])};c.includes(d[h])?g.push(i):f.push(i)}$(".container").html(f.map(Node).join("")),$(".ambushes").html(g.map(Node).join("")),0<c.length?$(".ambushes-header").show():$(".ambushes-header").hide()}