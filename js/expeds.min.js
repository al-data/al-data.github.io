var WAVE_DB={};function loadDb(){var a=$.getJSON("../data/wavedb.json",function(a){WAVE_DB=a});return Promise.all([a])}var WAVE_LIST=[],WAVE_DICT={};function loadWaves(a){WAVE_LIST=[],WAVE_DICT={};let b=a.d,c=loadDungeon(b),d=c.wl,e=c.w,f=[];for(let b=0;b<e.length;b++){let c=e[b],g=d[c],h=new Wave(c,a.l);h.fromData(g),g.tt==EWaveTriggerType.NORMAL&&h.isSubWave()?f.push(h):g.tt==EWaveTriggerType.NORMAL&&(h.idx=WAVE_LIST.length+1,WAVE_LIST.push(h)),WAVE_DICT[c]=h}for(let b,c=0;c<f.length;c++)b=f[c],b.idx=WAVE_LIST.length+1,WAVE_LIST.push(b);for(let b=0;b<WAVE_LIST.length;b++)WAVE_LIST[b].loadConditions(WAVE_DICT)}const TPL_TITLE=({chName:a,expedName:b})=>`<h1 class="hTitle">${a} \t ${b}</h1>`,TPL_HEADER=({text:a})=>`<h2>${a}</h2>`,TPL_SUB_HEADER=({text:a})=>`<h3>${a}</h3>`,ENEMY_TABLE_TMPL=({waveId:a,rows:b})=>`<table id="wave_${a}" class="table table-striped table-bordered dataTable no-footer" style="width:100%">
                    <thead>
                            <tr role="row">
                                <th class="sorting_asc" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Icon: activate to sort column descending" style="width: 27px;">Icon</th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label="Name: activate to sort column ascending" style="width: 101px;">
                                    <div style="width:100px;">Name</div>
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label=": activate to sort column ascending" style="width: 29px;">
                                    Type
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label="Level: activate to sort column ascending" style="width: 33px;">Level</th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label=": activate to sort column ascending" style="width: 29px;">
                                    <img src="img/attr/hp.png" style="width: 30px;">
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label=": activate to sort column ascending" style="width: 33px;">
                                    <img src="img/attr/armor.png" style="width: 30px;">
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label=": activate to sort column ascending" style="width: 29px;">
                                    <img src="img/attr/fp.png" style="width: 30px;">
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label=": activate to sort column ascending" style="width: 29px;">
                                    <img src="img/attr/torp.png" style="width: 30px;">
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label=": activate to sort column ascending" style="width: 29px;">
                                    <img src="img/attr/air.png" style="width: 30px;">
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label=": activate to sort column ascending" style="width: 29px;">
                                    <img src="img/attr/aa.png" style="width: 30px;">
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label=": activate to sort column ascending" style="width: 29px;">
                                    <img src="img/attr/eva.png" style="width: 30px;">
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label="Hit: activate to sort column ascending" style="width: 18px;">Hit</th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label="Luck: activate to sort column ascending" style="width: 30px;">Luck</th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label=" Priority: activate to sort column ascending" style="width: 69px;">
                                    <div style="">
                                        Prio
                                    </div>
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label="Notes: activate to sort column ascending" style="width: 74px;">
                                    <div style="width:60px;" >Notes</div>
                                </th>
                            </tr>
                    </thead>
                    <tbody>
                        ${b}
                        <!-- <tr role="row">
                            <td class="sorting_1">
                                <div style="width:40px; height:40px;">
                                    <img src="img/enemy-icons/birui.png" style="width:40px;">
                                </div>
                            </td>
                            <td>Hiei</td>
                            <td>60</td>
                            <td>7214</td>
                            <td>Medium</td>
                            <td>352</td>
                            <td>0</td>
                            <td>0</td>
                            <td>
                                <a href="#" class="material-tooltip-main" style="border-bottom: 1px dashed;" data-toggle="tooltip" title="56.14% air resistance">192</a>
                            </td>
                            <td>5</td>
                            <td>26</td>
                            <td>0</td>
                            <td>65</td>
                            <td>-</td>
                        </tr>
                        <tr role="row">
                            <td class="sorting_1">
                                <div style="width:40px; height:40px;">
                                    <img src="img/enemy-icons/ruihe.png" style="width:40px;">
                                </div>
                            </td>
                            <td>Zuikaku</td>
                            <td>60</td>
                            <td>5989</td>
                            <td>Medium</td>
                            <td>0</td>
                            <td>0</td>
                            <td>257</td>
                            <td>
                                <a href="#" class="material-tooltip-main" style="border-bottom: 1px dashed;" data-toggle="tooltip" title="57.51% air resistance">203</a>
                            </td>
                            <td>9</td>
                            <td>26</td>
                            <td>0</td>
                            <td>70</td>
                            <td>-</td>
                        </tr> -->
                    </tbody>
                </table>`,AIRCRAFT_TABLE_TMPL=({waveId:a,rows:b})=>`<table id="wave_${a}" class="table table-striped table-bordered dataTable no-footer" style="width:100%">
                    <thead>
                            <tr role="row">
                                <th class="sorting_asc" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Icon: activate to sort column descending" style="width: 27px;">Icon</th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label=": activate to sort column ascending" style="width: 29px;">
                                    Qty
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label="Level: activate to sort column ascending" style="width: 33px;">Level</th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label=": activate to sort column ascending" style="width: 29px;">
                                    <img src="img/attr/hp.png" style="width: 30px;">
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label=": activate to sort column ascending" style="width: 29px;">
                                    Crash
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label=": activate to sort column ascending" style="width: 29px;">
                                    <img src="img/attr/air.png" style="width: 30px;">
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label=": activate to sort column ascending" style="width: 29px;">
                                    <img src="img/attr/aa.png" style="width: 30px;">
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label="Hit: activate to sort column ascending" style="width: 18px;">Hit</th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label="Luck: activate to sort column ascending" style="width: 30px;">Luck</th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label="Notes: activate to sort column ascending" style="width: 60px;">
                                    Speed
                                </th>
                                <th class="sorting" tabindex="0" aria-controls="dtBasicExample" rowspan="1" colspan="1" aria-label="Notes: activate to sort column ascending" style="width: 74px;">
                                    Notes
                                </th>
                            </tr>
                    </thead>
                    <tbody>
                        ${b}
                    </tbody>
                </table>`,AIRCRAFT_ROW=({icon:a,num:b,lvl:c,hp:d,crash:e,avi:f,airRed:g,aa:h,hit:i,luck:j,speed:k,notes:l})=>`<tr role="row">
                <td class="sorting_1">
                    <div style="width:40px; height:40px;">
                        <img src="${a}" style="width:40px;">
                    </div>
                </td>
                <td>${b}</td>
                <td>${c}</td>
                <td>${d}</td>
                <td>${e}</td>
                <td>${f}</td>
                <td>
                    <div class="material-tooltip-main" style="width:fit-content; border-bottom: 1px dashed;" data-toggle="tooltip" title="${g}% air resistance">${h}</div>
                </td>
                <td>${i}</td>
                <td>${j}</td>
                <td>${k}</td>
                <td>${l}</td>
            </tr>`,ENEMY_ROW=({icon:a,name:b,type:c,lvl:d,hp:e,armor:f,fp:g,torp:h,avi:i,aa:j,eva:k,hit:l,luck:m,prio:n,notes:o,airRed:p})=>`<tr role="row">
                <td class="sorting_1">
                    <div style="width:40px; height:40px;">
                        <img src="${a}" style="width:40px;" onError="this.onError=null; this.src='img/enemy-icons/unknown.png'; ">
                    </div>
                </td>
                <td>${b}</td>
                <td>   
                    <div style="display:flex; justify-content:center; ${isSpecialType(c)?`padding-top:0.5rem`:`padding-top:0.5rem`}">
                        <img src="img/ship-types/${c}.png" style="${isSpecialType(c)?`width:50%`:`width:70%`};" data-toggle="tooltip" title="${EEnemyType.props[c].name}"></td>
                    </div>
                <td>${d}</td>
                <td>${e}</td>
                <td>${f}</td>
                <td>${g}</td>
                <td>${h}</td>
                <td>${i}</td>
                <td>
                    <div class="material-tooltip-main" style="width:fit-content; border-bottom: 1px dashed;" data-toggle="tooltip" title="${p}% air resistance">${j}</div>
                </td>
                <td>${k}</td>
                <td>${l}</td>
                <td>${m}</td>
                <td>${n}</td>
                <td style="white-space: pre-line;">${o}</td>
            </tr>`,ENEMY_ICON=({icon:a})=>`<div style="width:40px; height:40px;">
        <img src="img/enemy-icons/${a}.png" style="width:40px;">
    </div>`,CONDITION_ALERT=({waves:a,time:b})=>`<div class="alert alert-secondary" role="alert">
        <b>Condition:</b>
        ${null==a?``:`Clear wave(s) ${a}`}   
        ${null!=a&&-1!=b?` <b>OR</b> `:``}
        ${-1==b?``:`${b} seconds elapsed`}
    </div>`;function createExpedPage(a){let b=parseInt(a.id.toString().slice(0,-3)),c="";b in WAVE_DB.chapters&&(c=WAVE_DB.chapters[b].cn),$("#container").append(TPL_TITLE({chName:c,expedName:WAVE_DB.exNames[a.n]}));for(let b=0;b<WAVE_LIST.length;b++){let a=WAVE_LIST[b],c=a.getEnemyRows(),d="Wave "+a.idx;if(a.isSubWave()&&(d+=" (Sub Wave)"),$("#container").append(TPL_HEADER({text:d})),$("#container").append(`<div class="divWave" id="wave_${a.idx}"></div>`),0!=b){let b=a.getConditions(),c=b.waves.join(", ");(-1!=b.time||""!=c)&&$("#wave_"+a.idx).append(CONDITION_ALERT({waves:""==c?null:c,time:b.time}))}$("#wave_"+a.idx).append(TPL_SUB_HEADER({text:"Spawns"})),$("#wave_"+a.idx).append(ENEMY_TABLE_TMPL({waveId:"sp_"+a.idx,rows:c})),$("#wave_sp_"+a.idx).DataTable({paging:!1,searching:!1,info:!1});let e=a.getReinfRows();0<e.length&&($("#wave_"+a.idx).append(TPL_SUB_HEADER({text:"Reinforcements"})),$("#wave_"+a.idx).append(ENEMY_TABLE_TMPL({waveId:"rf_"+a.idx,rows:e})),$("#wave_rf_"+a.idx).DataTable({paging:!1,searching:!1,info:!1}));let f=a.getAirRows();0<f.length&&($("#wave_"+a.idx).append(TPL_SUB_HEADER({text:"Aircraft"})),$("#wave_"+a.idx).append(AIRCRAFT_TABLE_TMPL({waveId:"air_"+a.idx,rows:f})),$("#wave_air_"+a.idx).DataTable({paging:!1,searching:!1,info:!1})),$("#wave_"+a.idx).append("<hr>")}}var NUM_ATTRS=12,EEnemyType={props:{1:{name:"Destroyer",value:1,code:"DD"},2:{name:"Light Cruiser",value:2,code:"CL"},3:{name:"Heavy Cruiser",value:3,code:"CA"},4:{name:"Battlecruiser",value:4,code:"BC"},5:{name:"Battleship",value:5,code:"BB"},6:{name:"Light Carrier",value:6,code:"CVL"},7:{name:"Aircraft Carrier",value:7,code:"CV"},8:{name:"Submarine",value:8,code:"SS"},9:{name:"Aviation Cruiser",value:9,code:"CAV"},10:{name:"Aviation Battleship",value:10,code:"BBV"},11:{name:"-",value:11,code:"-"},12:{name:"Repair Ship",value:12,code:"AR"},13:{name:"Monitor",value:13,code:"BM"},14:{name:"Torpedo Ship",value:14,code:"-"},15:{name:"Cargo Ship",value:15,code:"-"},16:{name:"Bombing Ship",value:16,code:"-"},17:{name:"Aviation Submarine",value:17,code:"SSV"},18:{name:"Large Cruiser",value:18,code:"CB"}}};function isSpecialType(a){return 15==a||16==a}var EArmorType={LIGHT:1,MEDIUM:2,HEAVY:3,props:{1:{name:"Light Armor",value:1,code:"Light"},2:{name:"Medium Armor",value:2,code:"Medium"},3:{name:"Heavy Armor",value:3,code:"Heavy"}}},EAttributes={DURABILITY:0,CANNON:1,TORP:2,AA:3,AIR:4,RELOAD:5,ARMOR:6,HIT:7,EVA:8,SPEED:9,LUCK:10,ANTISUB:11,props:{0:{name:"Durability",value:0,code:"HP"},1:{name:"Firepower",value:1,code:"FP"},2:{name:"Torp",value:2,code:"TORP"},3:{name:"Anti-Air",value:3,code:"AA"},4:{name:"Airpower",value:4,code:"AP"},5:{name:"Reload",value:5,code:"REL"},6:{name:"Armor",value:6,code:"ARMOR"},7:{name:"Hit",value:7,code:"HIT"},8:{name:"Evasion",value:8,code:"EVA"},9:{name:"Speed",value:9,code:"SPD"},10:{name:"Luck",value:10,code:"LUCK"},11:{name:"Antisub",value:11,code:"ASW"}}},EWeaponType={MAIN_CANNON:1,SUB_CANNON:2,TORPEDO:3,ANTI_AIR:4,ARMOR:5,ENGINE:6,RADAR:7,PASSIVE_SCOUT:10,SCOUT:11,CREW:12,CHARGE:13,SPECIAL:14,MEGA_CHARGE:15,MANUAL_TORPEDO:16,ANTI_SEA:17,HAMMER_HEAD:18,BOMBER_PRE_CAST_ALERT:19,MULTI_LOCK:20,MANUAL_SUB:21,FLEET_ANTI_AIR:22,POINT_HIT_AND_LOCK:23,BEAM:24,DEPTH_CHARGE:25,REPEATER_ANTI_AIR:26,DISPOSABLE_TORPEDO:27,PREVIEW_ARICRAFT:99,AIR_ASSIST:100},EConditionType={AND:0,OR:1},EWaveTriggerType={NORMAL:0,TIMER:1,RANGE:2,STORY:3,AID:4,BGM:5,GUIDE:6,CAMERA:7,CLEAR:8,JAMMING:9};function loadEnemy(a){if(!(a in WAVE_DB.get))return console.log("No enemy in GET with id "+a),null;if(getEntry=WAVE_DB.get[a],realId=getEntry.id,!(realId in WAVE_DB.enemies))return console.log("No enemy with id "+realId),null;let b=WAVE_DB.enemies[realId],c=null;if("b"in b){let a=b.b;c=WAVE_DB.enemies[a]}return{base:c,enemy:b}}function loadIfExistsD(a,b,c){return b in a?a[b]:c}function calcStat(a,b,c,d){return 100<a?b+(a-1)*c/1e3+(a-100)*d/1e3:b+(a-1)*c/1e3}class Enemy{constructor(a,b){this.id=a,this.lvl=b,this.icon=null,this.name="",this.type=-1,this.nation=-1,this.armor=0,this.weight=0,this.stats=[],this.attrs=[],this.attrsGrowth=[];for(let c=0;c<NUM_ATTRS;c++)this.attrs[c]=0,this.attrsGrowth[c]=0,this.stats[c]=0;this.aircraft=[],this.loadData(a),this.setLevel(b),this.loadAircraft()}getLevel(){return this.lvl}getStat(a){return this.stats[a]}getCombatStat(a){return this.stats[a]}getArmor(){return this.armor}getType(){return this.type}getNation(){return this.nation}getFixedAmmo(){return null}loadStats(a){this.attrs=a.st,this.attrsGrowth=a.gr;let b=loadIfExistsD(a,"t",this.type);-1!=b&&(this.type=b),this.name=loadIfExistsD(a,"nm",this.name),this.icon=loadIfExistsD(a,"ic",this.icon),this.nation=loadIfExistsD(a,"n",this.nation),this.armor=loadIfExistsD(a,"at",this.armor),this.weight=loadIfExistsD(a,"w",this.weight),this.eqs=loadIfExistsD(a,"e",[]),this.spEqs=loadIfExistsD(a,"se",[]),this.eqs=this.eqs.concat(this.spEqs)}loadData(a){let b=loadEnemy(a);this.data=b;let c=b.base;c&&this.loadStats(c),this.loadStats(b.enemy)}loadAircraft(){for(let a,b=0;b<this.eqs.length;b++)a=new Aircraft(this.eqs[b],this.lvl,!0),a.fromMother(this.eqs[b],this)&&this.aircraft.push(a)}getAircraft(){return this.aircraft}calcStats(){for(let a=0;a<NUM_ATTRS;a++)this.stats[a]=Math.floor(calcStat(this.lvl,this.attrs[a],this.attrsGrowth[a],0))}setLevel(a){this.lvl=a,this.calcStats()}isEnemy(){return!0}getTagList(){return[]}isVanguard(){return!1}isMainFleet(){return!1}isFlagship(){return!1}isLeader(){return!1}getTemplId(){return this.id}isType(a){return 0!=(this.type&a)}airResist(){return(100*(1-150/(150+this.stats[EAttributes.AA]))).toFixed(2)}getEntry(){let a="";return this.isBoss?a+="Boss":this.isReinf?a+=(""==a?"":"\n")+"Reinforcement":a="-",["<div style='width:40px; height:40px;'><img src='img/enemy-icons/"+this.icon+".png' style='width:40px;' /></div>",this.name,this.lvl,this.stats[EAttributes.DURABILITY],EArmorType.props[this.armor].code,this.stats[EAttributes.CANNON],this.stats[EAttributes.TORP],this.stats[EAttributes.AIR],"<a class='material-tooltip-main' style='border-bottom: 1px dashed;' data-toggle='tooltip' title='"+this.airResist()+"% air resistance'>"+this.stats[EAttributes.AA]+"</a>",this.stats[EAttributes.EVA],this.stats[EAttributes.HIT],this.stats[EAttributes.LUCK],this.weight,a]}getStruct(){let a={};return a.icon="img/enemy-icons/"+this.icon+".png",a.name=this.name,a.type=this.type,a.lvl=this.lvl,a.hp=this.stats[EAttributes.DURABILITY],a.armor=EArmorType.props[this.armor].code,a.fp=this.stats[EAttributes.CANNON],a.torp=this.stats[EAttributes.TORP],a.avi=this.stats[EAttributes.AIR],a.aa=this.stats[EAttributes.AA],a.eva=this.stats[EAttributes.EVA],a.hit=this.stats[EAttributes.HIT],a.luck=this.stats[EAttributes.LUCK],a.prio=this.weight,a.notes="-",this.isBoss&&(a.notes="Boss"),a.airRed=this.airResist(),a}}function loadAircraft(a){if(!(a in WAVE_DB.aircraft))return console.log("No aircraft with id "+a),null;let b=WAVE_DB.aircraft[a];return b}function loadWeapon(a){if(!(a in WAVE_DB.weaps))return console.log("No weapon with id "+a),null;let b=WAVE_DB.weaps[a];return b}class Aircraft{constructor(a,b,c){this.id=a,this.lvl=b,this.icon=null,this.mother=null,this.fromCV=c,this.name="",this.type=-1,this.stats=[],this.attrs=[],this.attrsGrowth=[];for(let d=0;d<NUM_ATTRS;d++)this.attrs[d]=0,this.attrsGrowth[d]=0,this.stats[d]=0;this.weapons=[]}airResist(){return(100*(1-150/(150+this.attrs[EAttributes.AA]))).toFixed(2)}fromAirfighters(a){this.id=a.id;let b=loadAircraft(this.id);this.loadAircraftData(b),"w"in a&&(this.weapons=a.w),this.interval=a["in"],this.once=a.o,this.total=a.t,this.setStatsAirFighter(),this.numPlanes=this.once}fromMother(a,b){this.mother=b;let c=loadWeapon(a);if(c.t==EWeaponType.SCOUT){this.loadWeaponData(c);let b=loadAircraft(a);this.loadAircraftData(b)}else return!1;return this.setStatsMother(),!0}loadAircraftData(a){this.type=a.t,this.icon=a.ic,this.crash=a.c,this.attPower=a.at,this.speed=a.s,this.acc=a.a,this.maxHp=a.mh,this.apGrowth=a.apg,this.hpGrowth=a.hg,this.accGrowth=a.ac,this.weapons=a.w}loadWeaponData(a){this.rel=a.rl,this.numPlanes=a.bl[0].r}isFromMother(){return null!=this.mother}setStatsAirFighter(){let a=this.lvl-1;this.attrs[EAttributes.DURABILITY]=Math.floor(this.maxHp+this.hpGrowth*a/1e3);let b=this.attPower+this.apGrowth*a/1e3;this.attrs[EAttributes.CANNON]=b,this.attrs[EAttributes.TORP]=b,this.attrs[EAttributes.AA]=b,this.attrs[EAttributes.AIR]=b,this.attrs[EAttributes.ANTISUB]=b,this.attrs[EAttributes.RELOAD]=0,this.attrs[EAttributes.EVA]=0,this.attrs[EAttributes.LUCK]=50,this.attrs[EAttributes.HIT]=this.acc+this.accGrowth*a/1e3}setStatsMother(){if(null!=this.mother){for(let b=0;b<NUM_ATTRS;b++)this.attrs[b]=this.mother.stats[b];let a=this.mother.lvl;this.lvl=a;this.attrs[EAttributes.DURABILITY]=Math.floor(this.maxHp+this.hpGrowth*(a-1)/1e3),this.attrs[EAttributes.CANNON]=this.mother.stats[EAttributes.CANNON],this.attrs[EAttributes.TORP]=this.mother.stats[EAttributes.TORP],this.attrs[EAttributes.AA]=this.mother.stats[EAttributes.AA]}}getStruct(){let a={};return a.icon="img/aircraft-icons/"+this.icon+".png",a.crash=this.crash,a.name=this.name,a.lvl=this.lvl,a.num=this.numPlanes,a.hp=this.attrs[EAttributes.DURABILITY],a.fp=this.attrs[EAttributes.CANNON],a.avi=this.attrs[EAttributes.AIR],a.aa=this.attrs[EAttributes.AA],a.hit=this.attrs[EAttributes.HIT],a.luck=this.attrs[EAttributes.LUCK],a.speed=this.speed,a.notes="-",a.airRed=this.airResist(),a.notes=null==this.mother?`Total of ${Math.round(this.total/this.once)} wave(s) of ${this.once} units.`:ENEMY_ICON({icon:this.mother.icon}),a}}class Wave{constructor(a,b){this.id=a,this.lvl=b,this.triggerType=-1,this.preWaves=[],this.spawns=[],this.reinf=[],this.aircraft=[],this.time=-1,this.waveConds=[],this.timeCond=-1}fromData(a){this.id=a.wi,this.triggerType=a.tt,this.triggerType==EWaveTriggerType.TIMER?this.time=a.t:this.triggerType==EWaveTriggerType.NORMAL&&(this.preWaves=a.pw,this.loadSpawns(a))}loadConditions(){if(0<this.preWaves.length)for(let a=0;a<this.preWaves.length;a++){let b=this.preWaves[a],c=WAVE_DICT[b];c&&c.triggerType==EWaveTriggerType.NORMAL?this.waveConds.push(c.idx):c&&c.triggerType==EWaveTriggerType.TIMER&&-1==this.timeCond&&(this.timeCond=c.time)}}getConditions(){return{time:this.timeCond,waves:this.waveConds}}getEnemyRows(){let a=[];for(let b=0;b<this.spawns.length;b++)a.push(this.spawns[b].getStruct());return a.map(ENEMY_ROW).join("")}getReinfRows(){let a=[];for(let b=0;b<this.reinf.length;b++)a.push(this.reinf[b].getStruct());return a.map(ENEMY_ROW).join("")}getAirRows(){let a=[];for(let b=0;b<this.aircraft.length;b++)a.push(this.aircraft[b].getStruct());return a.map(AIRCRAFT_ROW).join("")}isSubWave(){for(let a=0;a<this.spawns.length;a++)if(17!=this.spawns[a].getType()&&8!=this.spawns[a].getType())return!1;for(let a=0;a<this.reinf.length;a++)if(17!=this.reinf[a].getType()&&8!=this.reinf[a].getType())return!1;return!(0<this.aircraft.length)&&(0!=this.spawns.length||0!=this.reinf.length)}loadSpawns(a){let b=a.sp;for(let c=0;c<b.length;c++){let a=b[c].id,d=b[c].b,e=new Enemy(a,this.lvl);e.isBoss=d,this.spawns.push(e)}let c=a.r;for(let b=0;b<c.length;b++){let a=c[b].id,d=c[b].b,e=new Enemy(a,this.lvl);e.isBoss=d,this.reinf.push(e)}let d=a.f;for(let b=0;b<d.length;b++){let a=d[b],c=new Aircraft(a.id,this.lvl,!1);c.fromAirfighters(a),this.aircraft.push(c)}for(let b,c=0;c<this.spawns.length;c++){b=this.spawns[c].getAircraft();for(let a=0;a<b.length;a++)this.aircraft.push(b[a])}}}function loadDungeon(a){if(!(a in WAVE_DB.dungs))return console.log("No dungeon with id "+a),null;let b=WAVE_DB.dungs[a];return b}